"use strict";(self.webpackChunkcertificate_creator=self.webpackChunkcertificate_creator||[]).push([[579],{2960:(e,t,a)=>{a.r(t),a.d(t,{default:()=>b});var i=a(5043),r=a(3969),s=a(9806),n=a(4799),o=a(4842),l=a(6803),c=a(2097),d=a(6020),x=a(298),u=a(1697),h=a(7305),p=a(3216),m=a(579);const f={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE_URL||"http://127.0.0.1:5000",b=()=>{const e=(0,p.Zp)(),[t,a]=(0,i.useState)(null),[b,g]=(0,i.useState)(""),[v,A]=(0,i.useState)(!1),[S,j]=(0,i.useState)(""),[C,w]=(0,i.useState)("");return(0,m.jsx)(r.A,{sx:{minHeight:"100vh",background:"#f7fafd",py:6},children:(0,m.jsx)(s.A,{maxWidth:"md",children:(0,m.jsxs)(n.A,{sx:{p:4,borderRadius:3,boxShadow:"0 8px 32px rgba(60, 80, 120, 0.12)"},children:[(0,m.jsx)(o.A,{variant:"h4",sx:{fontWeight:700,mb:2},children:"Bulk Upload Certificates"}),(0,m.jsx)(o.A,{variant:"body1",sx:{color:"#5a6c7d",mb:3},children:"Upload a CSV or Excel file to generate multiple certificates at once with the same design and border."}),b&&(0,m.jsx)(l.A,{severity:"error",sx:{mb:2},children:b}),(0,m.jsx)(o.A,{variant:"h6",sx:{fontWeight:600,mb:1},children:"Upload CSV/XLSX File"}),(0,m.jsxs)(o.A,{variant:"body2",sx:{color:"#5a6c7d",mb:2},children:["Upload an Excel (.xlsx) or CSV (.csv) file containing the required columns:",(0,m.jsx)("br",{}),(0,m.jsx)("strong",{children:"Recipient Name | Course Name | Certificate Date | Issuing Organization | Certificate Title | Certificate Description"})]}),(0,m.jsxs)(r.A,{sx:{display:"flex",gap:2,alignItems:"center",flexWrap:"wrap"},children:[(0,m.jsxs)(c.A,{variant:"outlined",component:"label",startIcon:(0,m.jsx)(u.A,{}),sx:{textTransform:"none",borderRadius:2},children:["Choose File (.csv, .xlsx)",(0,m.jsx)("input",{type:"file",hidden:!0,accept:".csv, .xlsx",onChange:e=>{g(""),j("");const t=e.target.files&&e.target.files[0];if(!t)return;if(!["text/csv","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(t.type)&&!t.name.match(/\.(csv|xlsx)$/i))return g("Please upload a .csv or .xlsx file."),void a(null);a(t)}})]}),(0,m.jsx)(o.A,{variant:"body2",sx:{color:"#3a6ea5"},children:t?t.name:"No file selected"})]}),(0,m.jsxs)(r.A,{sx:{mt:3,display:"flex",gap:2,alignItems:"center",flexWrap:"wrap"},children:[(0,m.jsx)(c.A,{variant:"contained",onClick:async()=>{if(g(""),w(""),j(""),t)try{A(!0),w("Preparing preview...");const a=new FormData;a.append("file",t);const i=await fetch(`${f}/bulk_preview_sample`,{method:"POST",body:a}),r=await i.json();if(!i.ok)throw new Error(r.error||"Failed to read file");const s=URL.createObjectURL(t);sessionStorage.setItem("bulkFileObjectUrl",s),sessionStorage.setItem("bulkFileName",t.name||"bulk.xlsx");const n=await new Promise((e,a)=>{const i=new FileReader;i.onload=()=>e(String(i.result).split(",")[1]||""),i.onerror=()=>a(i.error),i.readAsDataURL(t)});sessionStorage.setItem("bulkFileBase64",n);const o=r.sample||{};localStorage.setItem("certificateData",JSON.stringify({name:o["Recipient Name"]||"",course:o["Course Name"]||"",date:o["Certificate Date"]||"",issuer:o["Issuing Organization"]||"",certificateTitle:o["Certificate Title"]||"",paragraph:o["Certificate Description"]||""})),sessionStorage.setItem("bulkMode","true"),e("/creation/size"),w("Select a border, then preview. When you save, all certificates will generate.")}catch(a){const e=(null===a||void 0===a?void 0:a.message)||"An unexpected error occurred";g(`${e}. ${`Could not reach API at ${f}. Ensure backend is running (try opening ${f}/health) and that CORS/HTTPS are correct.`}`)}finally{A(!1)}else g("Please select a .csv or .xlsx file first.")},disabled:v,startIcon:(0,m.jsx)(u.A,{}),sx:{textTransform:"none",borderRadius:2},children:v?"Generating...":"Generate Certificates"}),v&&(0,m.jsx)(r.A,{sx:{flex:1,minWidth:200},children:(0,m.jsx)(d.A,{})})]}),C&&(0,m.jsx)(o.A,{variant:"body2",sx:{color:"#5a6ea5",mt:2},children:C}),S&&(0,m.jsx)(r.A,{sx:{mt:3},children:(0,m.jsx)(c.A,{component:"a",href:S,download:`certificates_${Date.now()}.zip`,variant:"contained",color:"success",startIcon:(0,m.jsx)(h.A,{}),sx:{textTransform:"none",borderRadius:2},children:"Download ZIP"})}),(0,m.jsxs)(r.A,{sx:{mt:4,p:3,backgroundColor:"#f8f9fa",borderRadius:2},children:[(0,m.jsx)(o.A,{variant:"h6",sx:{fontWeight:600,mb:2,color:"#2d3748"},children:"How it works:"}),(0,m.jsxs)(x.A,{spacing:1,children:[(0,m.jsx)(o.A,{variant:"body2",sx:{color:"#4a5568"},children:"1. Upload your CSV/XLSX file with recipient details"}),(0,m.jsx)(o.A,{variant:"body2",sx:{color:"#4a5568"},children:"2. Choose certificate size and border design"}),(0,m.jsx)(o.A,{variant:"body2",sx:{color:"#4a5568"},children:"3. Customize text positioning and styling"}),(0,m.jsx)(o.A,{variant:"body2",sx:{color:"#4a5568"},children:'4. Click "Save & Download" to generate all certificates'}),(0,m.jsx)(o.A,{variant:"body2",sx:{color:"#4a5568"},children:"5. Download as ZIP file containing all certificates with SHA-256 security"})]})]})]})})})}},9806:(e,t,a)=>{a.d(t,{A:()=>v});var i=a(5043),r=a(8387),s=a(6061),n=a(1807),o=a(3635),l=a(2335),c=a(883),d=a(9049),x=a(579);const u=(0,d.A)(),h=(0,c.A)("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,t[`maxWidth${(0,o.A)(String(a.maxWidth))}`],a.fixed&&t.fixed,a.disableGutters&&t.disableGutters]}}),p=e=>(0,l.A)({props:e,name:"MuiContainer",defaultTheme:u});var m=a(7194),f=a(8128),b=a(8301);const g=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{createStyledComponent:t=h,useThemeProps:a=p,componentName:l="MuiContainer"}=e,c=t(e=>{let{theme:t,ownerState:a}=e;return{width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",...!a.disableGutters&&{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}}}},e=>{let{theme:t,ownerState:a}=e;return a.fixed&&Object.keys(t.breakpoints.values).reduce((e,a)=>{const i=a,r=t.breakpoints.values[i];return 0!==r&&(e[t.breakpoints.up(i)]={maxWidth:`${r}${t.breakpoints.unit}`}),e},{})},e=>{let{theme:t,ownerState:a}=e;return{..."xs"===a.maxWidth&&{[t.breakpoints.up("xs")]:{maxWidth:Math.max(t.breakpoints.values.xs,444)}},...a.maxWidth&&"xs"!==a.maxWidth&&{[t.breakpoints.up(a.maxWidth)]:{maxWidth:`${t.breakpoints.values[a.maxWidth]}${t.breakpoints.unit}`}}}}),d=i.forwardRef(function(e,t){const i=a(e),{className:d,component:u="div",disableGutters:h=!1,fixed:p=!1,maxWidth:m="lg",classes:f,...b}=i,g={...i,component:u,disableGutters:h,fixed:p,maxWidth:m},v=((e,t)=>{const{classes:a,fixed:i,disableGutters:r,maxWidth:l}=e,c={root:["root",l&&`maxWidth${(0,o.A)(String(l))}`,i&&"fixed",r&&"disableGutters"]};return(0,n.A)(c,e=>(0,s.Ay)(t,e),a)})(g,l);return(0,x.jsx)(c,{as:u,ownerState:g,className:(0,r.A)(v.root,d),ref:t,...b})});return d}({createStyledComponent:(0,f.Ay)("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,t[`maxWidth${(0,m.A)(String(a.maxWidth))}`],a.fixed&&t.fixed,a.disableGutters&&t.disableGutters]}}),useThemeProps:e=>(0,b.b)({props:e,name:"MuiContainer"})}),v=g}}]);
//# sourceMappingURL=579.b6947295.chunk.js.map